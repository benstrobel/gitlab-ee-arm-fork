#!/bin/sh

cd <%= @options[:gitlab_rails_dir] %>/working

exec 2>&1

# This is useful to see in the logs; mail_room is very quiet
echo 'Runit: starting mail_room'

exec chpst -e /opt/gitlab/etc/gitlab-rails/env -P \
  -U <%= @options[:username] %>:<%= @options[:groupname] %> \
  -u <%= @options[:username] %>:<%= @options[:groupname] %> \
  /opt/gitlab/embedded/bin/bundle exec mail_room \
    -c <%= @options[:mail_room_config] %>
